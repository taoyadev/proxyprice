---
import BaseLayout from '../layouts/BaseLayout.astro';
import ComparisonTable from '../components/ComparisonTable.astro';
import TrustBadge from '../components/TrustBadge.astro';
import UpdatedDailyBadge from '../components/UpdatedDailyBadge.astro';
import providersData from '../data/providers.json';
import pricingData from '../data/pricing.json';
import { getFaviconUrl } from '../lib/favicon';
import { DATA_LAST_UPDATED } from '../lib/site';

const comparableProviders = providersData.providers.filter(p => p.cheapest_price_per_gb !== null);
const cheapestProvider = comparableProviders[0];

// Count by proxy type
const countByType = (type: string) => {
  return pricingData.pricing.filter(p => p.proxy_type === type && p.has_pricing).length;
};

// Calculate total comparable records
const totalComparableRecords = pricingData.pricing.filter(p => p.comparable).length;
const totalPricingRecords = pricingData.pricing.length;
const verificationRate = Math.round((totalComparableRecords / totalPricingRecords) * 100);
---

<BaseLayout
  title="Home"
  description={`Compare ${providersData.total_count}+ proxy providers side-by-side. Find the best $/GB rates for residential, datacenter, mobile & ISP proxies. Real pricing data from official sources, updated ${DATA_LAST_UPDATED}.`}
>
  <section class="hero">
    <div class="container">
      <h1>Stop Overpaying for Proxies</h1>
      <p class="hero-subtitle">
        The proxy market is confusing by design. We cut through the noise by normalizing pricing from {providersData.total_count}+ providers into one simple metric: <strong>cost per GB</strong>. No hidden fees, no marketing fluff.
      </p>
      <div class="hero-cta">
        <a href="/calculator" class="btn btn-primary">Calculate Your Savings</a>
        <a href="#comparison" class="btn btn-secondary">See All Prices</a>
      </div>

      <div class="hero-updated-badge">
        <UpdatedDailyBadge variant="hero" lastUpdated={DATA_LAST_UPDATED} />
      </div>

      <div class="hero-stats">
        <div class="stat">
          <div class="stat-value">{providersData.total_count}</div>
          <div class="stat-label">Providers</div>
        </div>
        <div class="stat">
          <div class="stat-value">{countByType('residential')}</div>
          <div class="stat-label">Residential</div>
        </div>
        <div class="stat">
          <div class="stat-value">{countByType('datacenter')}</div>
          <div class="stat-label">Datacenter</div>
        </div>
        <div class="stat">
          <div class="stat-value">{countByType('mobile')}</div>
          <div class="stat-label">Mobile</div>
        </div>
      </div>
    </div>
  </section>

  {cheapestProvider && (
    <section class="highlight-section">
      <div class="container">
        <div class="highlight-card">
          <span class="highlight-badge">Cheapest Overall</span>
          <img
            src={getFaviconUrl(cheapestProvider.website_url, 64)}
            alt={`${cheapestProvider.name} favicon`}
            class="highlight-favicon"
            width="64"
            height="64"
            loading="lazy"
            decoding="async"
          />
          <h2>{cheapestProvider.name}</h2>
          <p class="highlight-price">
            Starting at <strong>${cheapestProvider.cheapest_price_per_gb?.toFixed(2)}/GB</strong>
          </p>
          <div class="highlight-actions">
            <a href={`/provider/${cheapestProvider.slug}`} class="btn btn-outline">
              View Details
            </a>
            {cheapestProvider.trial_offer && (
              <span class="trial-tag">{cheapestProvider.trial_offer}</span>
            )}
          </div>
        </div>
      </div>
    </section>
  )}

  <section class="proxy-types" id="proxy-types">
    <div class="container">
      <h2>Browse by Proxy Type</h2>
      <div class="type-grid">
        <a href="/residential" class="type-card">
          <div class="type-icon">üè†</div>
          <h3>Residential Proxies</h3>
          <p>Real IPs from home networks via ISPs. Bypass anti-bot systems on protected sites like Amazon, Google, and social platforms. Rotating or sticky sessions available.</p>
          <div class="type-count">{countByType('residential')} providers with $/GB pricing</div>
        </a>

        <a href="/datacenter" class="type-card">
          <div class="type-icon">üè¢</div>
          <h3>Datacenter Proxies</h3>
          <p>Server-hosted IPs with sub-100ms latency and unlimited bandwidth. 10-50x cheaper than residential. Ideal for high-volume scraping where detection is not critical.</p>
          <div class="type-count">{countByType('datacenter')} providers compared</div>
        </a>

        <a href="/mobile" class="type-card">
          <div class="type-icon">üì±</div>
          <h3>Mobile Proxies</h3>
          <p>4G/5G IPs from real carrier networks. CGNAT means thousands of users share each IP naturally, making blocks nearly impossible. Premium pricing, premium trust.</p>
          <div class="type-count">{countByType('mobile')} providers tracked</div>
        </a>

        <a href="/isp" class="type-card">
          <div class="type-icon">üåê</div>
          <h3>ISP Proxies</h3>
          <p>Static IPs registered to ISPs but hosted in datacenters. Residential-level trust with datacenter speed. Perfect for account management and long sessions.</p>
          <div class="type-count">{countByType('isp')} providers available</div>
        </a>
      </div>
    </div>
  </section>

  <section class="comparison-section" id="comparison">
    <div class="container">
      <div class="section-header-with-trust">
        <div>
          <h2>Top Providers by Price</h2>
          <p class="section-subtitle">
            Showing providers with transparent per-GB pricing.
          </p>
        </div>
        <TrustBadge lastUpdated={DATA_LAST_UPDATED} variant="compact" providerCount={providersData.total_count} />
      </div>
      <ComparisonTable limit={20} showControls={false} />
      <div class="view-all">
        <a href="/providers" class="btn btn-secondary">View All Providers</a>
      </div>
    </div>
  </section>

  <section class="trust-section">
    <div class="container">
      <h2>Why Proxy Buyers Trust Us</h2>
      <p class="trust-subtitle">
        We built ProxyPrice because we were tired of spending hours comparing providers ourselves. No affiliate rankings, no paid placements. Just real pricing data.
      </p>

      <div class="trust-grid">
        <div class="trust-card">
          <div class="trust-icon-wrapper trust-icon-independent">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M9.661 2.237a.531.531 0 01.678 0 11.906.11l-.22.22a.531.531 0 01-.678 0l-.22-.22a.531.531 0 010-.678zm1.06 1.06a.531.531 0 00-.678 0l-.22.22a.531.531 0 000 .678l.22.22a.531.531 0 00.678 0l.22-.22a.531.531 0 000-.678zM8.315 4.284a.75.75 0 011.06 0l.531.531.531-.531a.75.75 0 111.06 1.06l-.531.531.531.531a.75.75 0 01-1.06 1.06l-.531-.531-.531.531a.75.75 0 01-1.06-1.06l.531-.531-.531-.531a.75.75 0 010-1.06zm.75 4.75a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5a.75.75 0 01.75-.75zM10 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 0110 13zm0-6a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 0110 7z" clip-rule="evenodd" />
              <path d="M10 2a8 8 0 100 16 8 8 0 000-16zM1 10a9 9 0 1118 0 9 9 0 01-18 0z" />
            </svg>
          </div>
          <h3>Zero Provider Ownership</h3>
          <p>Unlike "review" sites that are secretly owned by proxy companies, we have no financial stake in which provider you choose. Our only goal is accurate data.</p>
        </div>

        <div class="trust-card">
          <div class="trust-icon-wrapper trust-icon-verified">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
            </svg>
          </div>
          <h3>{verificationRate}% Manually Verified</h3>
          <p>Every price is pulled directly from official provider websites. We track {totalComparableRecords} pricing tiers that can be fairly compared using our $/GB standard.</p>
        </div>

        <div class="trust-card">
          <div class="trust-icon-wrapper trust-icon-updated">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" />
            </svg>
          </div>
          <h3>Fresh Data Always</h3>
          <p>
            Proxy pricing changes constantly. We monitor providers and update our database regularly so you never compare stale numbers.
            Last sync: {DATA_LAST_UPDATED}.
          </p>
        </div>

        <div class="trust-card">
          <div class="trust-icon-wrapper trust-icon-methodology">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z" />
            </svg>
          </div>
          <h3>Open Methodology</h3>
          <p>Wondering how we calculate $/GB from complex pricing tiers? We document everything. Check our methodology page to see exactly how we normalize data.</p>
        </div>
      </div>

      <div class="trust-metrics">
        <div class="metric">
          <div class="metric-value">{providersData.total_count}+</div>
          <div class="metric-label">Providers Tracked</div>
        </div>
        <div class="metric">
          <div class="metric-value">{totalPricingRecords}</div>
          <div class="metric-label">Pricing Records</div>
        </div>
        <div class="metric">
          <div class="metric-value">4</div>
          <div class="metric-label">Proxy Types</div>
        </div>
      </div>

      <div class="trust-cta">
        <a href="/methodology" class="btn btn-outline">Read Our Methodology</a>
        <a href="/about" class="btn btn-secondary">About ProxyPrice</a>
      </div>
    </div>
  </section>

  <section class="how-it-works">
    <div class="container">
      <h2>How We Cut Through the Confusion</h2>
      <div class="steps-grid">
        <div class="step">
          <div class="step-number">1</div>
          <h3>Collect Official Prices</h3>
          <p>We pull pricing directly from {providersData.total_count}+ provider websites. No third-party data, no outdated spreadsheets. Just current, verified pricing tiers.</p>
        </div>
        <div class="step">
          <div class="step-number">2</div>
          <h3>Normalize to $/GB</h3>
          <p>Providers use different models: per-GB, per-IP, bundled plans. We convert everything to a single standard so you can compare apples to apples.</p>
        </div>
        <div class="step">
          <div class="step-number">3</div>
          <h3>Find Your Match</h3>
          <p>Filter by proxy type, sort by price, or use our calculator to estimate costs for your specific bandwidth needs. Make informed decisions in minutes.</p>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<!-- Organization Schema -->
<script is:inline type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "ProxyPrice",
  "url": "https://proxyprice.com",
  "logo": "https://proxyprice.com/og-image.png",
  "description": "ProxyPrice is the leading independent proxy price comparison platform. Compare 40+ proxy providers with transparent, normalized pricing for residential, datacenter, mobile, and ISP proxies.",
  "sameAs": [
    "https://twitter.com/proxyprice",
    "https://github.com/proxyprice"
  ],
  "contactPoint": {
    "@type": "ContactPoint",
    "contactType": "customer support",
    "url": "https://proxyprice.com"
  },
  "founder": {
    "@type": "Organization",
    "name": "ProxyPrice"
  },
  "foundingDate": "2024",
  "areaServed": "Worldwide",
  "knowsAbout": [
    "residential proxies",
    "datacenter proxies",
    "mobile proxies",
    "ISP proxies",
    "web scraping proxies",
    "socks5 proxies",
    "rotating proxies",
    "static proxies"
  ]
}
</script>

<style>
  .hero {
    padding: 4rem 0;
    text-align: center;
    background: linear-gradient(135deg, var(--color-bg-alt) 0%, var(--color-bg) 100%);
  }

  .hero h1 {
    font-size: 3rem;
    margin-bottom: 1rem;
  }

  .hero-subtitle {
    font-size: 1.25rem;
    color: var(--color-text-light);
    max-width: 700px;
    margin: 0 auto 2rem;
  }

  .hero-cta {
    display: flex;
    gap: 1rem;
    justify-content: center;
    margin-bottom: 2rem;
  }

  .hero-updated-badge {
    display: flex;
    justify-content: center;
    margin-bottom: 2rem;
  }

  .btn {
    display: inline-block;
    padding: 0.875rem 2rem;
    border-radius: 0.5rem;
    font-weight: 600;
    transition: all 0.2s;
    text-decoration: none;
  }

  .btn-primary {
    background: var(--color-primary);
    color: white;
  }

  .btn-primary:hover {
    background: var(--color-primary-dark);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
  }

  .btn-secondary {
    background: transparent;
    color: var(--color-text);
    border: 2px solid var(--color-border);
  }

  .btn-secondary:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
  }

  .btn-outline {
    background: transparent;
    color: var(--color-primary);
    border: 2px solid var(--color-primary);
  }

  .btn-outline:hover {
    background: var(--color-primary);
    color: white;
  }

  .hero-stats {
    display: flex;
    justify-content: center;
    gap: 3rem;
    margin-top: 3rem;
  }

  .stat {
    text-align: center;
  }

  .stat-value {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--color-primary);
  }

  .stat-label {
    font-size: 0.875rem;
    color: var(--color-text-light);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .highlight-section {
    padding: 3rem 0;
    background: var(--color-bg-alt);
  }

  .highlight-card {
    max-width: 600px;
    margin: 0 auto;
    padding: 2rem;
    background: var(--color-bg);
    border: 2px solid var(--color-secondary);
    border-radius: 0.75rem;
    text-align: center;
  }

  .highlight-badge {
    display: inline-block;
    padding: 0.375rem 0.75rem;
    background: var(--color-secondary);
    color: white;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 1rem;
  }

  .highlight-favicon {
    border-radius: 0.75rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    margin-bottom: 1rem;
  }

  .highlight-price {
    font-size: 1.5rem;
    margin: 1rem 0;
  }

  .highlight-price strong {
    color: var(--color-secondary);
    font-size: 2rem;
  }

  .highlight-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    align-items: center;
    margin-top: 1.5rem;
  }

  .trial-tag {
    padding: 0.5rem 1rem;
    background: #fef3c7;
    color: #92400e;
    border-radius: 0.375rem;
    font-size: 0.875rem;
    font-weight: 600;
  }

  .proxy-types {
    padding: 4rem 0;
  }

  .proxy-types h2 {
    text-align: center;
    margin-bottom: 3rem;
  }

  .type-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;
  }

  .type-card {
    padding: 2rem;
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: 0.75rem;
    text-decoration: none;
    color: var(--color-text);
    transition: all 0.2s;
  }

  .type-card:hover {
    border-color: var(--color-primary);
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
  }

  .type-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
  }

  .type-card h3 {
    margin-bottom: 0.75rem;
  }

  .type-card p {
    color: var(--color-text-light);
    font-size: 0.875rem;
    margin-bottom: 1rem;
  }

  .type-count {
    color: var(--color-primary);
    font-weight: 600;
    font-size: 0.875rem;
  }

  .comparison-section {
    padding: 4rem 0;
    background: var(--color-bg-alt);
  }

  .section-header-with-trust {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 2rem;
  }

  .section-subtitle {
    color: var(--color-text-light);
    margin-bottom: 0;
  }

  .trust-section {
    padding: 4rem 0;
    background: linear-gradient(180deg, var(--color-bg-alt) 0%, var(--color-bg) 100%);
  }

  .trust-section h2 {
    text-align: center;
    margin-bottom: 0.75rem;
  }

  .trust-subtitle {
    text-align: center;
    color: var(--color-text-light);
    max-width: 700px;
    margin: 0 auto 3rem;
    font-size: 1.125rem;
  }

  .trust-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
  }

  .trust-card {
    padding: 2rem;
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: 0.75rem;
    text-align: center;
    transition: all 0.2s;
  }

  .trust-card:hover {
    border-color: var(--color-primary);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
    transform: translateY(-2px);
  }

  .trust-icon-wrapper {
    width: 3.5rem;
    height: 3.5rem;
    margin: 0 auto 1.25rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.75rem;
  }

  .trust-icon-wrapper svg {
    width: 1.75rem;
    height: 1.75rem;
    color: white;
  }

  .trust-icon-independent {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
  }

  .trust-icon-verified {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
  }

  .trust-icon-updated {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
  }

  .trust-icon-methodology {
    background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
  }

  .trust-card h3 {
    margin-bottom: 0.75rem;
    font-size: 1.25rem;
  }

  .trust-card p {
    color: var(--color-text-light);
    font-size: 0.9375rem;
    line-height: 1.6;
  }

  .trust-metrics {
    display: flex;
    justify-content: center;
    gap: 4rem;
    padding: 2.5rem;
    background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
    border-radius: 1rem;
    margin-bottom: 2rem;
  }

  .metric {
    text-align: center;
  }

  .metric-value {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--color-secondary);
    line-height: 1;
  }

  .metric-label {
    font-size: 0.875rem;
    color: var(--color-text-light);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-top: 0.5rem;
  }

  .trust-cta {
    display: flex;
    justify-content: center;
    gap: 1rem;
  }

  @media (prefers-color-scheme: dark) {
    .trust-metrics {
      background: linear-gradient(135deg, #064e3b 0%, #065f46 100%);
    }
  }

  .view-all {
    margin-top: 2rem;
    text-align: center;
  }

  .how-it-works {
    padding: 4rem 0;
  }

  .how-it-works h2 {
    text-align: center;
    margin-bottom: 3rem;
  }

  .steps-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 3rem;
  }

  .step {
    text-align: center;
  }

  .step-number {
    width: 4rem;
    height: 4rem;
    margin: 0 auto 1.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-primary);
    color: white;
    border-radius: 50%;
    font-size: 1.5rem;
    font-weight: 700;
  }

  .step h3 {
    margin-bottom: 0.75rem;
  }

  .step p {
    color: var(--color-text-light);
    font-size: 0.875rem;
  }

  @media (max-width: 768px) {
    .hero h1 {
      font-size: 2rem;
    }

    .hero-subtitle {
      font-size: 1rem;
    }

    .hero-cta {
      flex-direction: column;
      align-items: center;
    }

    .hero-stats {
      gap: 1.5rem;
    }

    .stat-value {
      font-size: 2rem;
    }

    .type-grid,
    .steps-grid {
      grid-template-columns: 1fr;
    }

    .section-header-with-trust {
      flex-direction: column;
      align-items: flex-start;
    }

    .trust-metrics {
      gap: 2rem;
      padding: 1.5rem;
    }

    .trust-cta {
      flex-direction: column;
      align-items: center;
    }
  }
</style>
