---
import BaseLayout from "../layouts/BaseLayout.astro";
import TrustBadge from "../components/TrustBadge.astro";
import pricingData from "../data/pricing.json";
import providersData from "../data/providers.json";

const totalPricingRecords = pricingData.pricing.length;
const comparableRecords = pricingData.pricing.filter(p => p.comparable).length;
const verificationRate = Math.round((comparableRecords / totalPricingRecords) * 100);
---

<BaseLayout
  title="Methodology"
  description="How ProxyPrice collects, normalizes, and compares proxy pricing. Learn what makes pricing comparable ($/GB conversion) and why some pricing models cannot be fairly converted."
>
  <div class="container" style="padding: 3rem 0;">
    <header class="page-header">
      <h1>Our Methodology</h1>
      <p class="page-subtitle">
        Proxy providers use wildly different pricing models. This page explains exactly how we normalize them for fair comparison, what we mark as comparable, and where conversion would be misleading.
      </p>
      <div class="header-trust">
        <TrustBadge lastUpdated={pricingData.last_updated} variant="inline" providerCount={providersData.total_count} />
      </div>
    </header>

    <section class="transparency-card">
      <div class="transparency-header">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
        </svg>
        <h2>Data Independence Guarantee</h2>
      </div>
      <p class="transparency-text">
        ProxyPrice is independently operated. We have no ownership stakes, exclusive partnerships, or financial arrangements with any proxy provider. Rankings are determined purely by normalized pricing data, not affiliate commissions or promotional agreements.
      </p>
      <div class="transparency-metrics">
        <div class="tm-item">
          <span class="tm-value">{providersData.total_count}+</span>
          <span class="tm-label">Providers</span>
        </div>
        <div class="tm-item">
          <span class="tm-value">{totalPricingRecords}</span>
          <span class="tm-label">Pricing Records</span>
        </div>
        <div class="tm-item">
          <span class="tm-value">{verificationRate}%</span>
          <span class="tm-label">Verified</span>
        </div>
      </div>
    </section>

    <section class="content">
      <h2>Comparable vs Non-Comparable Pricing</h2>
      <p>
        We mark a pricing record as <strong>comparable</strong> only when we can mathematically convert it to a reliable <strong>$/GB</strong> rate. This happens when:
      </p>
      <ul>
        <li>The provider publishes an explicit per-GB rate (e.g., <code>$5/GB</code>)</li>
        <li>The plan includes both total cost and bandwidth allocation (e.g., <code>$600/50GB</code> converts to <code>$12/GB</code>)</li>
      </ul>

      <p>
        We mark pricing as <strong>non-comparable</strong> when conversion would be misleading:
      </p>
      <ul>
        <li><strong>Per-IP pricing</strong> without bandwidth limits (e.g., <code>$5/IP/month</code> with "unlimited" bandwidth)</li>
        <li><strong>Per-port or per-thread pricing</strong> where bandwidth varies by usage pattern</li>
        <li><strong>Custom/enterprise pricing</strong> that requires contacting sales</li>
      </ul>

      <div class="info-box">
        <div class="info-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
          </svg>
        </div>
        <div class="info-content">
          <strong>Why We Refuse to Convert Per-IP Pricing</strong>
          <p>If Provider A offers $3/IP with 50GB bandwidth and Provider B offers $5/IP with unlimited bandwidth, converting both to "$/GB" would unfairly penalize Provider B. We show these as-is so you can evaluate the full picture.</p>
        </div>
      </div>

      <h2>How We Calculate $/GB</h2>
      <ul>
        <li><strong>Direct rate:</strong> If the tier shows <code>$X/GB</code>, we use that value directly.</li>
        <li><strong>Bundle conversion:</strong> For plans like <code>$600/50GB</code>, we divide: <code>600 / 50 = $12.00/GB</code>.</li>
        <li><strong>Tiered pricing:</strong> For each provider + proxy type combination, we track the <strong>min</strong> (cheapest tier) and <strong>max</strong> (most expensive tier) $/GB rates.</li>
        <li><strong>Volume discounts:</strong> We capture multiple tiers when available, so you can see both entry-level and enterprise rates.</li>
      </ul>

      <h2>Data Collection Process</h2>
      <ol>
        <li><strong>Provider Discovery:</strong> We identify proxy providers through industry research, competitor analysis, and user submissions. We prioritize providers with public, transparent pricing.</li>
        <li><strong>Manual Collection:</strong> Pricing data is manually extracted from official provider websites. We capture plan names, bandwidth allocations, costs, and any restrictions or conditions.</li>
        <li><strong>Normalization:</strong> Raw pricing is converted to our standard format with computed $/GB rates where applicable.</li>
        <li><strong>Verification:</strong> Each entry is cross-checked against the source URL before publication. We note any ambiguities or conditions.</li>
        <li><strong>Regular Updates:</strong> We monitor major providers for pricing changes and update our database accordingly. The update frequency varies by provider importance.</li>
      </ol>

      <h2>Sorting and Ranking Logic</h2>
      <ul>
        <li><strong>Comparison tables:</strong> Sort by <strong>min $/GB</strong> (lowest first) for comparable records. Non-comparable records appear separately or at the end.</li>
        <li><strong>Price calculator:</strong> Recommends providers by finding the cheapest tier that meets your requested bandwidth amount.</li>
        <li><strong>"Best" rankings:</strong> Limited to comparable providers only. We rank purely by lowest available $/GB rate.</li>
      </ul>

      <h2>Data Freshness</h2>
      <p>
        Dataset last synchronized: <strong>{pricingData.last_updated}</strong>. We actively monitor major providers and typically update within 1-2 weeks of significant pricing changes. If you notice stale or incorrect data, please <a href="https://github.com/proxyprice/proxyprice/issues">report an issue</a> and we will correct it promptly.
      </p>
    </section>

    <section class="disclaimer-section">
      <h3>Important Disclaimer</h3>
      <p>
        ProxyPrice is an independent comparison platform. We do not sell proxies directly and have no ownership or exclusive partnership arrangements with any provider. While we strive for accuracy, proxy pricing changes frequently and we cannot guarantee real-time accuracy. Always verify current pricing on the provider's official website before making a purchase decision. Our $/GB calculations are based on published pricing at the time of data collection. Actual costs may vary based on your specific usage patterns, negotiated rates, or promotional offers.
      </p>
    </section>
  </div>
</BaseLayout>

<style>
  .page-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .page-subtitle {
    font-size: 1.125rem;
    color: var(--color-text-light);
    max-width: 860px;
    margin: 1rem auto 0;
  }

  .header-trust {
    margin-top: 1.5rem;
    display: flex;
    justify-content: center;
  }

  .transparency-card {
    max-width: 900px;
    margin: 0 auto 3rem;
    padding: 2rem;
    background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
    border: 1px solid #a7f3d0;
    border-radius: 1rem;
  }

  .transparency-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1rem;
  }

  .transparency-header svg {
    width: 2rem;
    height: 2rem;
    color: #059669;
  }

  .transparency-header h2 {
    margin: 0;
    font-size: 1.5rem;
    color: #065f46;
  }

  .transparency-text {
    color: #047857;
    line-height: 1.6;
    margin-bottom: 1.5rem;
  }

  .transparency-metrics {
    display: flex;
    gap: 2rem;
  }

  .tm-item {
    display: flex;
    flex-direction: column;
  }

  .tm-value {
    font-size: 2rem;
    font-weight: 700;
    color: #059669;
  }

  .tm-label {
    font-size: 0.875rem;
    color: #047857;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .content {
    max-width: 900px;
    margin: 0 auto;
  }

  .content h2 {
    margin: 2.5rem 0 0.75rem;
  }

  .content h2:first-of-type {
    margin-top: 0;
  }

  .content ul {
    padding-left: 1.25rem;
  }

  .content ol {
    padding-left: 1.5rem;
  }

  .content li {
    margin-bottom: 0.5rem;
  }

  .info-box {
    display: flex;
    gap: 1rem;
    padding: 1.25rem;
    background: var(--color-bg-alt);
    border-left: 4px solid var(--color-primary);
    border-radius: 0.5rem;
    margin: 1.5rem 0;
  }

  .info-icon {
    flex-shrink: 0;
    width: 1.5rem;
    height: 1.5rem;
    color: var(--color-primary);
  }

  .info-content strong {
    display: block;
    margin-bottom: 0.25rem;
  }

  .info-content p {
    margin: 0;
    color: var(--color-text-light);
    font-size: 0.9375rem;
  }

  .disclaimer-section {
    max-width: 900px;
    margin: 3rem auto 0;
    padding: 1.5rem;
    background: var(--color-bg-alt);
    border: 1px solid var(--color-border);
    border-radius: 0.75rem;
  }

  .disclaimer-section h3 {
    margin: 0 0 0.75rem;
    font-size: 1.125rem;
  }

  .disclaimer-section p {
    margin: 0;
    color: var(--color-text-light);
    font-size: 0.9375rem;
    line-height: 1.6;
  }

  @media (prefers-color-scheme: dark) {
    .transparency-card {
      background: linear-gradient(135deg, #064e3b 0%, #065f46 100%);
      border-color: #047857;
    }

    .transparency-header h2,
    .transparency-text {
      color: #d1fae5;
    }

    .tm-value,
    .tm-label {
      color: #a7f3d0;
    }

    .transparency-header svg {
      color: #a7f3d0;
    }
  }

  @media (max-width: 768px) {
    .transparency-metrics {
      gap: 1rem;
    }

    .tm-value {
      font-size: 1.5rem;
    }
  }
</style>
